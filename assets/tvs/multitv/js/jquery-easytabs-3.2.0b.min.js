/*
 * jQuery EasyTabs plugin 3.2.0
 *
 * Copyright (c) 2010-2011 Steve Schwartz (JangoSteve)
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Date: Thu May 09 17:30:00 2013 -0500
 */
(function(e){e.easytabs=function(t,n){var r=this,i=e(t),s={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInEasing:"swing",transitionOutEasing:"swing",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",transitionCollapseEasing:"swing",transitionUncollapseEasing:"swing",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true,event:"click",panelContext:i},o,u,a,f,l,c={fast:200,normal:400,slow:600},h;r.init=function(){r.settings=h=e.extend({},s,n);h.bind_str=h.event+".easytabs";if(h.uiTabs){h.tabActiveClass="ui-tabs-selected";h.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all";h.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";h.tabClass="ui-state-default ui-corner-top";h.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"}if(h.collapsible&&n.defaultTab!==undefined&&n.collpasedByDefault===undefined){h.collapsedByDefault=false}if(typeof h.animationSpeed==="string"){h.animationSpeed=c[h.animationSpeed]}e("a.anchor").remove().prependTo("body");i.data("easytabs",{});r.setTransitions();r.getTabs();d();v();g();E();S();i.attr("data-easytabs",true)};r.setTransitions=function(){a=h.animate?{show:h.transitionIn,hide:h.transitionOut,speed:h.animationSpeed,collapse:h.transitionCollapse,uncollapse:h.transitionUncollapse,halfSpeed:h.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};r.getTabs=function(){var t;r.tabs=i.find(h.tabs),r.panels=e(),r.tabs.each(function(){var n=e(this),i=n.children("a"),s=n.children("a").data("target");n.data("easytabs",{});if(s!==undefined&&s!==null){n.data("easytabs").ajax=i.attr("href")}else{s=i.attr("href")}s=s.match(/#([^\?]+)/)[1];t=h.panelContext.find("#"+s);if(t.length){t.data("easytabs",{position:t.css("position"),visibility:t.css("visibility")});t.not(h.panelActiveClass).hide();r.panels=r.panels.add(t);n.data("easytabs").panel=t}else{r.tabs=r.tabs.not(n);if("console"in window){console.warn("Warning: tab without matching panel for selector '#"+s+"' removed from set")}}})};r.selectTab=function(e,t){var n=window.location,i=n.hash.match(/^[^\?]*/)[0],s=e.parent().data("easytabs").panel,o=e.parent().data("easytabs").ajax;if(h.collapsible&&!l&&(e.hasClass(h.tabActiveClass)||e.hasClass(h.collapsedClass))){r.toggleTabCollapse(e,s,o,t)}else if(!e.hasClass(h.tabActiveClass)||!s.hasClass(h.panelActiveClass)){y(e,s,o,t)}else if(!h.cache){y(e,s,o,t)}};r.toggleTabCollapse=function(e,t,n,s){r.panels.stop(true,true);if(p(i,"easytabs:before",[e,t,h])){r.tabs.filter("."+h.tabActiveClass).removeClass(h.tabActiveClass).children().removeClass(h.tabActiveClass);if(e.hasClass(h.collapsedClass)){if(n&&(!h.cache||!e.parent().data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[e,t]);t.load(n,function(n,r,s){e.parent().data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[e,t,n,r,s])})}e.parent().removeClass(h.collapsedClass).addClass(h.tabActiveClass).children().removeClass(h.collapsedClass).addClass(h.tabActiveClass);t.addClass(h.panelActiveClass)[a.uncollapse](a.speed,h.transitionUncollapseEasing,function(){i.trigger("easytabs:midTransition",[e,t,h]);if(typeof s=="function")s()})}else{e.addClass(h.collapsedClass).parent().addClass(h.collapsedClass);t.removeClass(h.panelActiveClass)[a.collapse](a.speed,h.transitionCollapseEasing,function(){i.trigger("easytabs:midTransition",[e,t,h]);if(typeof s=="function")s()})}}};r.matchTab=function(e){return r.tabs.find("[href='"+e+"'],[data-target='"+e+"']").first()};r.matchInPanel=function(e){return e&&r.validId(e)?r.panels.filter(":has("+e+")").first():[]};r.validId=function(e){return e.substr(1).match(/^[A-Za-z][A-Za-z0-9\-_:\.]*$/)};r.selectTabFromHashChange=function(){var e=window.location.hash.match(/^[^\?]*/)[0],t=r.matchTab(e),n;if(h.updateHash){if(t.length){l=true;r.selectTab(t)}else{n=r.matchInPanel(e);if(n.length){e="#"+n.attr("id");t=r.matchTab(e);l=true;r.selectTab(t)}else if(!o.hasClass(h.tabActiveClass)&&!h.cycle){if(e===""||r.matchTab(f).length||i.closest(e).length){l=true;r.selectTab(u)}}}}};r.cycleTabs=function(t){if(h.cycle){t=t%r.tabs.length;$tab=e(r.tabs[t]).children("a").first();l=true;r.selectTab($tab,function(){setTimeout(function(){r.cycleTabs(t+1)},h.cycle)})}};r.publicMethods={select:function(t){var n;if((n=r.tabs.filter(t)).length===0){if((n=r.tabs.find("a[href='"+t+"']")).length===0){if((n=r.tabs.find("a"+t)).length===0){if((n=r.tabs.find("[data-target='"+t+"']")).length===0){if((n=r.tabs.find("a[href$='"+t+"']")).length===0){e.error("Tab '"+t+"' does not exist in tab set")}}}}}else{n=n.children("a").first()}r.selectTab(n)}};var p=function(t,n,r){var i=e.Event(n);t.trigger(i,r);return i.result!==false};var d=function(){i.addClass(h.containerClass);r.tabs.parent().addClass(h.tabsClass);r.tabs.addClass(h.tabClass);r.panels.addClass(h.panelClass)};var v=function(){var t=window.location.hash.match(/^[^\?]*/)[0],n=r.matchTab(t).parent(),i;if(n.length===1){o=n;h.cycle=false}else{i=r.matchInPanel(t);if(i.length){t="#"+i.attr("id");o=r.matchTab(t).parent()}else{o=r.tabs.parent().find(h.defaultTab);if(o.length===0){e.error("The specified default tab ('"+h.defaultTab+"') could not be found in the tab set ('"+h.tabs+"') out of "+r.tabs.length+" tabs.")}}}u=o.children("a").first();m(n)};var m=function(t){var n,r;if(h.collapsible&&t.length===0&&h.collapsedByDefault){o.addClass(h.collapsedClass).children().addClass(h.collapsedClass)}else{n=e(o.data("easytabs").panel);r=o.data("easytabs").ajax;if(r&&(!h.cache||!o.data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[u,n]);n.load(r,function(e,t,r){o.data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[u,n,e,t,r])})}o.data("easytabs").panel.show().addClass(h.panelActiveClass);o.addClass(h.tabActiveClass).children().addClass(h.tabActiveClass)}i.trigger("easytabs:initialised",[u,n])};var g=function(){r.tabs.children("a").bind(h.bind_str,function(t){h.cycle=false;l=false;r.selectTab(e(this));t.preventDefault?t.preventDefault():t.returnValue=false})};var y=function(e,t,n,s){r.panels.stop(true,true);if(p(i,"easytabs:before",[e,t,h])){var o=r.panels.filter(":visible"),u=t.parent(),c,d,v,m,g=window.location.hash.match(/^[^\?]*/)[0];if(h.animate){c=b(t);d=o.length?w(o):0;v=c-d}f=g;m=function(){i.trigger("easytabs:midTransition",[e,t,h]);if(h.animate&&h.transitionIn=="fadeIn"){if(v<0)u.animate({height:u.height()+v},a.halfSpeed).css({"min-height":""})}if(h.updateHash&&!l){if(window.history.pushState){window.history.pushState(null,null,"#"+t.attr("id"))}else{window.location.hash="#"+t.attr("id")}}else{l=false}t[a.show](a.speed,h.transitionInEasing,function(){u.css({height:"","min-height":""});i.trigger("easytabs:after",[e,t,h]);if(typeof s=="function"){s()}})};if(n&&(!h.cache||!e.parent().data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[e,t]);t.load(n,function(n,r,s){e.parent().data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[e,t,n,r,s])})}if(h.animate&&h.transitionOut=="fadeOut"){if(v>0){u.animate({height:u.height()+v},a.halfSpeed)}else{u.css({"min-height":u.height()})}}r.tabs.filter("."+h.tabActiveClass).removeClass(h.tabActiveClass).children().removeClass(h.tabActiveClass);r.tabs.filter("."+h.collapsedClass).removeClass(h.collapsedClass).children().removeClass(h.collapsedClass);e.parent().addClass(h.tabActiveClass).children().addClass(h.tabActiveClass);r.panels.filter("."+h.panelActiveClass).removeClass(h.panelActiveClass);t.addClass(h.panelActiveClass);if(o.length){o[a.hide](a.speed,h.transitionOutEasing,m)}else{t[a.uncollapse](a.speed,h.transitionUncollapseEasing,m)}}};var b=function(t){if(t.data("easytabs")&&t.data("easytabs").lastHeight){return t.data("easytabs").lastHeight}var n=t.css("display"),r,i;try{r=e("<div></div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})}catch(s){r=e("<div></div>",{visibility:"hidden",overflow:"hidden"})}i=t.wrap(r).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight();t.unwrap();t.css({position:t.data("easytabs").position,visibility:t.data("easytabs").visibility,display:n});t.data("easytabs").lastHeight=i;return i};var w=function(e){var t=e.outerHeight();if(e.data("easytabs")){e.data("easytabs").lastHeight=t}else{e.data("easytabs",{lastHeight:t})}return t};var E=function(){if(typeof e(window).hashchange==="function"){e(window).hashchange(function(){r.selectTabFromHashChange()})}else if(e.address&&typeof e.address.change==="function"){e.address.change(function(){r.selectTabFromHashChange()})}};var S=function(){var e;if(h.cycle){e=r.tabs.index(o);setTimeout(function(){r.cycleTabs(e+1)},h.cycle)}};r.init()};e.fn.easytabs=function(t){var n=arguments;return this.each(function(){var r=e(this),i=r.data("easytabs");if(undefined===i){i=new e.easytabs(this,t);r.data("easytabs",i)}if(i.publicMethods[t]){return i.publicMethods[t](Array.prototype.slice.call(n,1))}})}})(jQuery)
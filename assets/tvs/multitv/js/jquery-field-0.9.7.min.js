/*
 * jQuery Field Plug-in
 *
 * Copyright (c) 2011 Dan G. Switzer, II
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Version: 0.9.7
 */
!function(a){var b={delimiter:",",checkboxRangeKeyBinding:"shiftKey",useArray:!1};a.Field={version:"0.9.6",setDefaults:function(c){a.extend(b,c)},setProperty:function(a,c){b[a]=c},getProperty:function(a){return b[a]}},a.fn.fieldArray=function(a){var e=i(a);return"undefined"==e?c(this):(("string"==e||"number"==e)&&(a=a.toString().split(b.delimiter),e="array"),"array"==e?d(this,a):this)},a.fn.getValue=function(){return c(this).join(b.delimiter)};var c=function(a){var b=[];return a.each(function(){var a=f(this);switch(a){case"checkbox":case"radio":this.checked&&b.push(this.value);break;case"select":if("select-one"==this.type)b.push(-1==this.selectedIndex?"":g(this[this.selectedIndex]));else for(var c=0;c<this.length;c++)this[c].selected&&b.push(g(this[c]));break;case"text":b.push(this.value);break;default:"undefined"!=typeof this.value&&b.push(this.value)}}),b};a.fn.setValue=function(a){return d(this,a||0===a?a.toString().split(b.delimiter):[""])};var d=function(a,c){return a.each(function(){var d,a=f(this);switch(a){case"checkbox":case"radio":this.checked=h(c,this.value);break;case"select":for(var j,e="select-one"==this.type,i=!0,k=0;k<this.length;k++)if(d=g(this[k]),j=h(c,d)){if(this[k].selected=!0,e){i=!1;break}}else e||(this[k].selected=!1);e&&i&&this[0]&&(this[0].selected=!0);break;case"text":this.value=c.join(b.delimiter);break;default:this.value=c.join(b.delimiter)}}),a};a.fn.formHash=function(c,d){var e=0==arguments.length,f={};return this.filter("form").each(function(){for(var h,i,k,g=this.elements,j={},l=0,m=g.length;m>l;l++)h=g[l],i=h.name,i&&!j[i]&&(k=a(h.form[i]),e?f[i]=k[b.useArray?"fieldArray":"getValue"]():i in c?k[b.useArray?"fieldArray":"setValue"](c[i]):d===!0&&k[b.useArray?"fieldArray":"setValue"](""),j[i]=!0)}),e?f:this},a.fn.fieldHash=function(c,d){var e=!(c&&"object"==typeof c),f={},g={};return this.filter(":input").each(function(){var h=this,i=h.name;if(i&&!g[i]){var j=a(h.form[i]);e?f[i]=j[b.useArray?"fieldArray":"getValue"]():i in c?j[b.useArray?"fieldArray":"setValue"](c[i]):d===!0&&j[b.useArray?"fieldArray":"setValue"](""),g[i]=!0}}),e?f:this},a.fn.autoAdvance=function(b){return this.find(":text,:password,textarea").bind("keyup.autoAdvance",function(c){var d=a(this),e=parseInt(d.attr("maxlength"),10);if(isNaN(e)||"|9|16|37|38|39|40|".indexOf("|"+c.keyCode+"|")>-1)return!0;if(d.getValue().length>=d.attr("maxlength")){var f=d.moveNext().select();a.isFunction(b)&&b.apply(d,[f])}})},a.fn.moveNext=function(){return this.moveIndex("next")},a.fn.movePrev=function(){return this.moveIndex("prev")},a.fn.moveIndex=function(b){var c=e(this);return"next"==b?b=c[0]+1:"prev"==b&&(b=c[0]-1),0>b?b=c[1].length-1:b>=c[1].length&&(b=0),a(c[1][b]).trigger("focus")},a.fn.getTabIndex=function(){return e(this)[0]};var e=function(b){var c=b.filter("input, select, textarea").get(0),d=[],e=[];if(!c)return[-1,[]];a.each(c.form.elements,function(a,b){"FIELDSET"!=b.tagName&&!b.disabled&&jQuery(b).is(":visible")&&(b.tabIndex>0?d.push(b):e.push(b))}),d.sort(function(a,b){return a.tabIndex-b.tabIndex}),d=a.merge(d,e);for(var f=0;f<d.length;f++)if(d[f]==c)return[f,d];return[-1,d]};a.fn.limitSelection=function(b,e){var f=jQuery.extend(b&&b.constructor==Object?b:{limit:b,onsuccess:function(){return!0},onfailure:function(a){return alert("You can only select a maximum a of "+a+" items."),!1}},e),g=this,h=function(b){return"select-multiple"==b.type?a("option:selected",g).length:"checkbox"==b.type?g.filter(":checked").length:0},i=function(){return d(g,c(g).slice(0,f.limit)),f.onfailure.apply(g,[f.limit])};return this.bind(g[0]&&"select-multiple"==g[0].type?"change.limitSelection":"click.limitSelection",function(){return h(this)>f.limit?"select-multiple"==this.type?i():f.onfailure.apply(g,[f.limit]):(f.onsuccess.apply(g,[f.limit]),!0)})},a.fn.createCheckboxRange=function(c){var d=jQuery.extend(c&&c.constructor==Object?c:{bind:b.checkboxRangeKeyBinding,click:c},c),e=0,f=this,g=a.isFunction(d.click);return g&&this.each(function(){d.click.apply(this,[a.event.fix({type:null}),a(this).is(":checked")])}),this.each(function(){if("checkbox"!=this.type)return!1;var b=function(a){e=f.index(a.target)},c=function(a){var b=this.checked,c=f.index(a.target),h=Math.min(e,c),i=Math.max(e+1,c);if(g&&d.click.apply(this,[a,b]),!a[d.bind])return!1;for(var j=h;i>j;j++){var k=f.eq(j).attr("checked",b).trigger("change");g&&d.click.apply(k[0],[a,b])}return!0};return a(this).unbind("click.createCheckboxRange").bind("click.createCheckboxRange",c).bind("click.createCheckboxRange",b),!0})};var f=function(a){var b=a.type;switch(b){case"select":case"select-one":case"select-multiple":b="select";break;case"text":case"hidden":case"textarea":case"password":case"button":case"submit":case"file":b="text";break;case"checkbox":case"radio":}return b},g=function(a){return a.value||(a.attributes&&a.attributes.value&&!a.attributes.value.specified?a.text:null)||""},h=function(b,c){return a.inArray(c,b)>-1},i=function(a){var b=(typeof a).toLowerCase();return"object"==b&&(a instanceof Array?b="array":a instanceof Date&&(b="date")),b}}(jQuery);